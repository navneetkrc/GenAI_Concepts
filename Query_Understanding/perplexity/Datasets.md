# Datasets for Query Rewriting in Search Systems

Query rewriting represents a crucial component of modern search systems, enabling more accurate interpretation of user queries and ultimately delivering improved search results. Effective query rewriting depends heavily on high-quality datasets for training and evaluation. This analysis examines several significant datasets specifically designed for query rewriting across different domains, highlighting their characteristics, construction methodologies, and applications for researchers and practitioners working on search optimization.

## E-commerce Query Rewriting Datasets

E-commerce platforms present unique challenges for query understanding, requiring specialized datasets that capture the distinctive patterns and intentions behind shopping-related searches. Several notable datasets have emerged to address these specific needs in the retail search domain.

### Taobao Query Rewriting Dataset

One significant dataset in the e-commerce domain comes from the Taobao search system. As outlined in recent research, this dataset focuses specifically on long-tail query rewriting challenges in e-commerce search[2]. The dataset construction process sources rewrites from Taobao's previous-generation rewriting policy, creating training pairs where each user query is matched with a corresponding rewrite. This approach yields a substantial dataset where search log data forms the foundation for training query rewriting models[2].

What makes this dataset particularly valuable is its focus on aligning with actual e-commerce search objectives. The dataset construction methodology follows a pattern where they select the top-ranked rewrite from the list generated by their previous policy as the gold standard candidate. This ensures that the dataset reflects realistic user queries and practical rewriting patterns. The formal construction can be represented as D = {(xi, yi)}Ni=1 where xi represents original queries sampled from the Taobao search distribution, and yi represents rewrites generated by their previous policy[2].

This dataset also incorporates additional dimensions beyond simple query pairs, incorporating quality classification, query correction, and chain-of-thought components that make it particularly suited for fine-tuning large language models for query rewriting tasks[2]. The multi-faceted nature of this dataset allows it to address the semantic gap problem often associated with long-tail queries in e-commerce settings.

### Shopping Intent Learning Dataset

Another approach to dataset construction for e-commerce query rewriting focuses on capturing shopping intent. As described in Amazon's research, this methodology relies on widely available search logs to generate source-target query pairs augmented with additional shopping intent information[1]. This dataset is specifically designed to transform tail queries (less common searches) into queries with characteristics similar to head queries (frequent searches) while preserving the original shopping intent.

The dataset incorporates additional information beyond simple query pairs, providing auxiliary data on product names and categories that helps capture the full shopping intent. This supplementary information enables the training of models that can better understand the underlying purpose of e-commerce queries, making it particularly valuable for applications in sponsored search and product recommendations[1].

## Conversational Query Rewriting Datasets

Conversational systems require specialized datasets that capture the contextual nature of multi-turn dialogues, where query understanding must account for previous interactions.

### Contextual Query Rewrite (CQR) Dataset

The Contextual Query Rewrite (CQR) Dataset, developed for spoken dialogue systems, represents a significant resource for conversational query rewriting research. Created by Alexa and available on GitHub since March 2019, this dataset contains crowd-sourced rewrites of dialogues from the Stanford Dialogue Corpus[4]. The primary motivation behind this dataset is to facilitate research in dialogue state tracking using natural language as an interface.

The CQR dataset addresses a fundamental challenge in dialogue assistant systems: understanding context across multiple turns and communicating that context across different domain-specific agents. By providing natural language rewrites, this dataset explores using language itself as an API for cross-agent communication, eliminating the need to learn diverse schema mappings[4]. This approach leverages the inherent syntactic and semantic regularities of language as a mechanism for tracking dialogue state.

The dataset is presented in JSON format, with each record representing a dialogue interaction. Its public availability makes it a valuable resource for researchers working on contextual understanding in conversational systems, particularly for applications involving multiple specialized dialogue agents that need to share context[4].

### QueryR and ContextCarryoverR Datasets

Another significant pair of datasets for conversational query rewriting are the QueryR and ContextCarryoverR datasets. These datasets address two distinct but related challenges in conversational systems: friction reduction (recovering from speech recognition or system errors) and contextual carryover (maintaining context across conversation turns)[3].

The QueryR dataset is weakly annotated by a defect detection model to identify patterns where a user's first utterance was problematic but the second was successful. This dataset includes approximately one million non-defective queries that don't require rewriting, providing necessary negative examples for model training[3].

Complementing this, the ContextCarryoverR dataset contains human annotations specifically for contextual carryover queries. It includes one million queries that require context carryover and one million that don't, creating a balanced dataset for training models to determine when context should be maintained across conversation turns[3].

These datasets are constructed from real-world conversational interactions, with training and validation data collected over a one-month period (split 9:1) and testing data from a subsequent one-week period. Importantly, there is no overlap between QueryR and CarryoverR, ensuring that models trained on both datasets learn to distinguish between different types of query rewriting needs[3].

## General Search Query Datasets

Beyond specialized domains like e-commerce and conversational systems, some datasets focus on general search query rewriting applications.

### AOL4PS Dataset

The AOL4PS dataset represents a large-scale resource constructed specifically for personalized search evaluation[5]. Collected and processed from AOL query logs, this dataset addresses a significant gap in publicly available personalized search datasets. While not exclusively focused on query rewriting, the dataset provides valuable information for query suggestion and document ranking tasks that often interface with query rewriting systems.

A key challenge addressed by this dataset is the lack of candidate documents in the original AOL query logs, which only contain records of user-clicked documents. The researchers behind AOL4PS generated candidate document lists for each query and annotated documents that users found satisfactory[5]. To overcome computational bottlenecks in processing the large-scale logs, they implemented an improved BM25 algorithm that made the construction of this comprehensive dataset feasible.

The dataset underwent careful preprocessing to remove incorrect and redundant data, addressing challenges such as incomplete log records and data duplication caused by server merging[5]. This cleaning process ensures that the resulting dataset provides a reliable foundation for search personalization research, including query suggestion components that often involve query rewriting techniques.

## Implementation Considerations for Dataset Selection

When selecting datasets for query rewriting research or application development, several factors should be considered to ensure alignment with specific use cases and requirements.

The domain specificity of the dataset is a critical consideration. E-commerce query rewriting presents different challenges than conversational or general web search rewriting, making datasets like the Taobao collection or shopping intent learning dataset more appropriate for retail applications. Conversely, the CQR dataset or QueryR/ContextCarryoverR combinations are better suited for developing conversational systems.

Dataset size and quality also vary significantly. The Taobao and AOL4PS datasets offer large-scale collections with millions of examples, while specialized conversational datasets may be smaller but offer higher-quality annotations. Researchers should consider whether their application benefits more from scale or annotation quality when selecting training data.

The nature of annotations differs across datasets as well. Some provide simple query pairs, while others include rich contextual information, intent classifications, or quality judgments. The training objectives should align with the annotation style to ensure the resulting models address the specific aspects of query rewriting most relevant to the target application.

## Conclusion

A variety of specialized datasets exist to support query rewriting research and development across different domains. E-commerce-focused collections like the Taobao dataset and shopping intent learning dataset capture the unique challenges of retail search. Conversational datasets including CQR, QueryR, and ContextCarryoverR address the complexities of maintaining context and recovering from errors in multi-turn dialogues. General search datasets like AOL4PS provide broader coverage for personalized search applications.

The availability of these diverse datasets enables researchers and practitioners to develop more effective query rewriting systems tailored to specific domains and use cases. By selecting appropriate training data and evaluation benchmarks, search system developers can significantly improve query understanding capabilities, ultimately delivering more relevant results and enhanced user experiences across e-commerce platforms, conversational assistants, and general search engines.

When implementing query rewriting systems, selecting the right combination of datasets for training and evaluation remains a critical decision that should be guided by the specific requirements and constraints of the target application domain. The continued development of specialized, high-quality datasets will further advance the state of query rewriting technology across all search domains.

Citations:
[1] https://www.amazon.science/publications/advancing-query-rewriting-in-e-commerce-via-shopping-intent-learning
[2] https://arxiv.org/pdf/2311.03758.pdf
[3] https://aclanthology.org/2023.acl-industry.58.pdf
[4] https://github.com/alexa/alexa-dataset-contextual-query-rewrite
[5] https://direct.mit.edu/dint/article-abstract/3/4/548/106757

---
Answer from Perplexity: pplx.ai/share
